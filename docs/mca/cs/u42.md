# Forensic Tools and Techniques

Computer forensics uses specialized tools and techniques to identify, preserve, and analyze digital evidence.

### Forensic Tool Suites

These are all-in-one platforms for in-depth investigations.
- **FTK (Forensic Toolkit)**: A complete suite for disk imaging, file carving, and email analysis.
- **EnCase**: An industry-standard commercial tool for deep forensic examination.
- **Autopsy / The Sleuth Kit**: A popular open-source platform for timeline analysis and data recovery.

#### Data seen using forensics tools:

History files, Un-allocated space, File stack, FAT information, Hidden files, Formatted files and file systems on disks, Temporary files, Data clusters


## Specialized Techniques and Technologies

### File Carving

**File carving** is a technique used to recover files from a storage device's raw data, without relying on the file system's metadata. It works by scanning for known file patterns, like headers and footers, and extracting the data between them. This is essential for recovering deleted or corrupted files from unallocated disk space or memory dumps.

**Key Use Cases:**
- Recovering deleted files from a hard drive or flash memory.
- Extracting images, documents, or other files from unstructured data dumps.
- Supporting forensic investigations in cybercrime cases.
- Assisting in malware analysis by extracting embedded files from memory dumps.
    
**Key Limitations:**
- Files without recognizable headers or footers cannot be carved.
- **Fragmented files** (stored in non-contiguous blocks) may be recovered incompletely or corrupted.
- It cannot restore file system **metadata**, such as the original filename, timestamps, or permissions.
    
| Tool                   | Description                                                                                                |
| ---------------------- | ---------------------------------------------------------------------------------------------------------- |
| **Scalpel**            | A fast and efficient file carver that uses pattern matching and header/footer specifications.              |
| **Foremost**           | Originally developed by the U.S. Air Force, it recovers files based on their data structures (signatures). |
| **PhotoRec**           | A powerful tool that recovers a wide variety of file formats and works well with damaged partitions.       |
| **Autopsy/Sleuth Kit** | A full-featured forensic platform with built-in file carving capabilities.                                 |


## RAID (Redundant Array of Independent Disks)

**RAID** is a storage technology that combines multiple physical disks into one logical unit to improve performance and provide fault tolerance.

- Improve performance by reading/writing data across multiple disks simultaneously.
    
- Increase data redundancy and provide **fault tolerance** in case one or more drives fail.

#### Common RAID Levels

| RAID Level        | Description                                                                                                 | Use in Forensics                                                                                       |
| ----------------- | ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------ |
| **RAID 0**        | **Striping.** Data is split across disks without redundancy. It's fast but has no fault tolerance.          | Recovery is very difficult if even one disk is missing or damaged.                                     |
| **RAID 1**        | **Mirroring.** Data is written identically to two disks.                                                    | Recovery is straightforward as a complete copy of the data exists on the mirror disk.                  |
| **RAID 5**        | **Striping with Parity.** Data and parity information are striped across at least three disks.              | Common in enterprises. Reconstructing the array can be complex due to the parity calculation.          |
| **RAID 6**        | **Striping with Double Parity.** Similar to RAID 5 but with an extra parity block for more fault tolerance. | More resilient than RAID 5 but even more difficult to analyze and reconstruct manually.                |
| **RAID 10 (1+0)** | **A Stripe of Mirrors.** Combines the speed of striping with the redundancy of mirroring.                   | Highly fault-tolerant. Requires deep analysis and specialized tools to reconstruct the logical volume. |

Handling RAID is a critical skill in forensics because evidence may be distributed across multiple disks. 

The general process involves:
1.  **Identifying** the RAID configuration (e.g., RAID 0, 1, 5).
2.  **Acquiring** a forensic image of *every* disk in the array.
3.  **Reconstructing** the RAID array virtually using specialized software.
4.  **Analyzing** the reconstructed volume to find evidence and carve for deleted files.

## Forensic Toolkit: COFEE

The **Computer Online Forensics Evidence Extractor (COFEE)** is a toolkit developed by Microsoft for law enforcement. It is a USB-based device containing over 150 tools designed to quickly collect digital evidence from a live (running) Windows system.

**Key Features:**
- Automates the collection of internet history, running processes, and RAM dumps.
- Decrypt passwords, display internet activity, and uncover all data shared on the computer. 
- Designed for on-site data acquisition in time-sensitive operations.
- The toolkit is provided only to law enforcement and must be used with proper legal authority. 
	    
- List open network connections
    
- Search and recover deleted files
    
- Bypass some security features like user passwords (under legal warrant)

## Specialized Forensic Techniques

- **Hash Analysis**: Using algorithms like MD5 or SHA-256 to verify file integrity and identify known malicious files.
- **File Carving**: Recovering deleted files from unallocated disk space by searching for file headers and footers.
- **Steganalysis**: Detecting data that has been concealed within other files, such as images or audio files.
- **Timeline Analysis**: Reconstructing events by analyzing file system timestamps.
- **Data Mining**: Using techniques like entity extraction and clustering to identify patterns from large datasets.
* **Registry Analysis** : Investigating the Windows Registry to uncover evidence of user activity, program execution, and system configuration changes.
* **Metadata Extraction** : Pulling hidden information from files, such as author, creation date, and GPS coordinates (e.g., from EXIF data in photos).

## Network Forensic Tools

These tools focus on capturing and analyzing network traffic to investigate security incidents.

* Wireshark : The go-to tool for capturing and interactively analyzing network packets in real-time.
* TCPdump: A powerful command-line packet sniffer used for quick capture and analysis directly on a server or network device.
* NetworkMiner: An excellent tool for extracting files, images, credentials, and other metadata from captured network traffic (PCAP files).
* Xplico: A web-based forensic tool that analyzes packet captures to reconstruct web pages, emails, and VoIP calls.

## Challenges in Computer Forensics

Forensic investigators face numerous technical, legal, and procedural challenges, including:
- **Sophisticated anti-forensics**: Techniques used to hide, destroy, or manipulate evidence.
- **Encrypted/cloud-based data**: Difficulty accessing data that is encrypted or stored in the cloud.
- **Complex storage systems**: Systems like RAID distribute data across multiple disks, complicating reconstruction.
- **Legal and jurisdictional hurdles**: Navigating different laws and jurisdictions when evidence is spread globally.


## Forensics Auditing

Forensic auditing is a specialized area of accounting that combines auditing with investigative techniques to detect and prevent financial crimes like fraud and embezzlement. Its findings are prepared in a way that can be used in legal proceedings.

To deter fraud, a multi-faceted approach is needed, encompassing strong policies, employee training, robust security measures, and a culture of vigilance and reporting. 

Key techniques include **Benford's Law Analysis** to detect anomalies in numbers, **digital forensics** to recover manipulated records, and **data mining** to identify suspicious transactions from large datasets.


Forensic Auditing is Applied on: 

- Corporate fraud investigations (e.g., embezzlement, asset misappropriation)
    
- Financial statement fraud (e.g., revenue inflation, asset overstatement)
    
- Insurance claims verification
    
- Corruption and bribery investigations
    
- Tax evasion or money laundering detection
    
- Internal whistle blower complaints

## Anti-forensics

Anti-forensics is the practice of preventing, interfering with, or complicating the process of digital forensic analysis. The goal is to hide, destroy, or manipulate evidence, mislead investigators, or delay the analysis process.

Common anti-forensics techniques include:
- **Data wiping**: Securely deleting data to make recovery impossible.

- **Metadata manipulation**: Altering timestamps or file history.

- **Steganography**: Hiding data inside other files like images or audio.

- **Encryption**: Using strong encryption to prevent access to data.

- **Transmogrify**: Transforming data to make it appear benign or meaningless, such as renaming a malicious `.exe` file to a `.jpg`.

- **Rootkits and backdoors** â€“ maintaining hidden access while avoiding detection.

- **Timestomping** - changing file creation/modification times to mislead analysis.

